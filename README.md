# How to use our project

You need docker to be installed on your machine.

## How to use the bash script to download Nist Data

```shell
cd .. && mkdir cve-nist && cd cve-nist
./../cve-scrapper-classifier/cve-nist/nist-cve-dl.sh 
```

## How to download the CVE from Mitre

```shell
cd ..
git clone git@github.com:CVEProject/cvelistV5.git
```

## Set up Elastic

```shell
cp ./elastic/.env.tpl ./elastic/.env
```

Set the password for Elastic and Kibana in the .env file

```shell
cd ./elastic && make
```

## Expected architecture

The folder that contains the data are expected to be on the same level as the folder that contains the code.

```shell
.
├── cve-scrapper-classifier
├── cve_nist
├── cvelistV5
```

## Update or install SearchSploit

We use SearchSploit to look for active exploits for specific CVEs.  
Thus, the need of the database to be up to date.  
(https://www.exploit-db.com/searchsploit)

**Kali Linux**
```
kali@kali:~$ sudo apt update && sudo apt -y install exploitdb
```
or
```
searchsploit -u
```

**Debian / Ubuntu with snap**
```
sudo snap install searchsploit
```

## Create a Python virtual environment to run python files

Download miniconda from : <https://docs.anaconda.com/free/miniconda/index.html>

Run :

```shell
conda env create --file env.yml
conda activate pfa
```

## OpenAI API key setup

Create an environment variable with your OpenAI API key

```shell
export OPENAI_API_KEY='your-apikey'
```

## Launch LLM to generate an objective CVSS for a specific CVE

Choose your LLM by changing the non-commented line in the main function of llm.py

```shell
python3 llm.py
```

## Additionals

**VulDB Database**  
In case you want to download details for a specific CVE in JSON format from this database following the same architecture as cvelistV5.  
You will need a VulDB API key where you can use 50 tokens per day with a free account.
```
cd cve-vuldb
python3 vuldb-filter.py <CVE-ID> <api-key>
```
